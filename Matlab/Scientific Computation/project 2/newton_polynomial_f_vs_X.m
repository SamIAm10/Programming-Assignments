clear; % clear all stored variables

% frequency (f) data (MHz)
x_data = [9.00, 9.60, 10.20, 10.80, 11.40, ...
    12.00, 12.60, 13.20, 13.80, 14.40, 15.00, ...
    15.60, 16.20, 16.80, 17.40, 18.00];

% reactance (X) data (Ohm)
y_data = [229.49, 190.98, 154.00, 117.74, ...
    81.36, 43.84, 3.90, -40.33, -91.81, ...
    -155.33, -237.61, -330.25, -231.01, ...
    229.80, 247.89, 152.36];

% define the divided differences (from 5th to 16th data point, for a total of 12 data points)
f0 = y_data(5);
f1 = y_data(6);
f2 = y_data(7);
f3 = y_data(8);
f4 = y_data(9);
f5 = y_data(10);
f6 = y_data(11);
f7 = y_data(12);
f8 = y_data(13);
f9 = y_data(14);
f10 = y_data(15);
f11 = y_data(16);

x0 = x_data(5);
x1 = x_data(6);
x2 = x_data(7);
x3 = x_data(8);
x4 = x_data(9);
x5 = x_data(10);
x6 = x_data(11);
x7 = x_data(12);
x8 = x_data(13);
x9 = x_data(14);
x10 = x_data(15);
x11 = x_data(16);

% first order divided differences
f01 = (f1 - f0)/(x1 - x0);
f12 = (f2 - f1)/(x2 - x1);
f23 = (f3 - f2)/(x3 - x2);
f34 = (f4 - f3)/(x4 - x3);
f45 = (f5 - f4)/(x5 - x4);
f56 = (f6 - f5)/(x6 - x5);
f67 = (f7 - f6)/(x7 - x6);
f78 = (f8 - f7)/(x8 - x7);
f89 = (f9 - f8)/(x9 - x8);
f910 = (f10 - f9)/(x10 - x9);
f1011 = (f11 - f10)/(x11 - x10);

% second order
f012 = (f12 - f01)/(x2 - x0);
f123 = (f23 - f12)/(x3 - x1);
f234 = (f34 - f23)/(x4 - x2);
f345 = (f45 - f34)/(x5 - x3);
f456 = (f56 - f45)/(x6 - x4);
f567 = (f67 - f56)/(x7 - x5);
f678 = (f78 - f67)/(x8 - x6);
f789 = (f89 - f78)/(x9 - x7);
f8910 = (f910 - f89)/(x10 - x8);
f91011 = (f1011 - f910)/(x11 - x9);

% third
f0123 = (f123 - f012)/(x3 - x0);
f1234 = (f234 - f123)/(x4 - x1);
f2345 = (f345 - f234)/(x5 - x2);
f3456 = (f456 - f345)/(x6 - x3);
f4567 = (f567 - f456)/(x7 - x4);
f5678 = (f678 - f567)/(x8 - x5);
f6789 = (f789 - f678)/(x9 - x6);
f78910 = (f8910 - f789)/(x10 - x7);
f891011 = (f91011 - f8910)/(x11 - x8);

% fourth
f01234 = (f1234 - f0123)/(x4 - x0);
f12345 = (f2345 - f1234)/(x5 - x1);
f23456 = (f3456 - f2345)/(x6 - x2);
f34567 = (f4567 - f3456)/(x7 - x3);
f45678 = (f5678 - f4567)/(x8 - x4);
f56789 = (f6789 - f5678)/(x9 - x5);
f678910 = (f78910 - f6789)/(x10 - x6);
f7891011 = (f891011 - f78910)/(x11 - x7);

% fifth
f012345 = (f12345 - f01234)/(x5 - x0);
f123456 = (f23456 - f12345)/(x6 - x1);
f234567 = (f34567 - f23456)/(x7 - x2);
f345678 = (f45678 - f34567)/(x8 - x3);
f456789 = (f56789 - f45678)/(x9 - x4);
f5678910 = (f678910 - f56789)/(x10 - x5);
f67891011 = (f7891011 - f678910)/(x11 - x6);

% sixth
f0123456 = (f123456 - f012345)/(x6 - x0);
f1234567 = (f234567 - f123456)/(x7 - x1);
f2345678 = (f345678 - f234567)/(x8 - x2);
f3456789 = (f456789 - f345678)/(x9 - x3);
f45678910 = (f5678910 - f456789)/(x10 - x4);
f567891011 = (f67891011 - f5678910)/(x11 - x5);

% seventh
f01234567 = (f1234567 - f0123456)/(x7 - x0);
f12345678 = (f2345678 - f1234567)/(x8 - x1);
f23456789 = (f3456789 - f2345678)/(x9 - x2);
f345678910 = (f45678910 - f3456789)/(x10 - x3);
f4567891011 = (f567891011 - f45678910)/(x11 - x4);

% eighth
f012345678 = (f12345678 - f01234567)/(x8 - x0);
f123456789 = (f23456789 - f12345678)/(x9 - x1);
f2345678910 = (f345678910 - f23456789)/(x10 - x2);
f34567891011 = (f4567891011 - f345678910)/(x11 - x3);

% ninth
f0123456789 = (f123456789 - f012345678)/(x9 - x0);
f12345678910 = (f2345678910 - f123456789)/(x10 - x1);
f234567891011 = (f34567891011 - f2345678910)/(x11 - x2);

% tenth
f012345678910 = (f12345678910 - f0123456789)/(x10 - x0);
f1234567891011 = (f234567891011 - f12345678910)/(x11 - x1);

% eleventh
f01234567891011 = (f1234567891011 - f012345678910)/(x11 - x0);

% resulting polynomial
syms x;
p = f0 ...
    + f01*(x - x0) ...
    + f012*(x - x0)*(x - x1) ...
    + f0123*(x - x0)*(x - x1)*(x - x2) ...
    + f01234*(x - x0)*(x - x1)*(x - x2)*(x - x3) ...
    + f012345*(x - x0)*(x - x1)*(x - x2)*(x - x3)*(x - x4) ...
    + f0123456*(x - x0)*(x - x1)*(x - x2)*(x - x3)*(x - x4)*(x - x5) ...
    + f01234567*(x - x0)*(x - x1)*(x - x2)*(x - x3)*(x - x4)*(x - x5)*(x - x6) ...
    + f012345678*(x - x0)*(x - x1)*(x - x2)*(x - x3)*(x - x4)*(x - x5)*(x - x6)*(x - x7) ...
    + f0123456789*(x - x0)*(x - x1)*(x - x2)*(x - x3)*(x - x4)*(x - x5)*(x - x6)*(x - x7)*(x - x8) ...
    + f012345678910*(x - x0)*(x - x1)*(x - x2)*(x - x3)*(x - x4)*(x - x5)*(x - x6)*(x - x7)*(x - x8)*(x - x9) ...
    + f01234567891011*(x - x0)*(x - x1)*(x - x2)*(x - x3)*(x - x4)*(x - x5)*(x - x6)*(x - x7)*(x - x8)*(x - x9)*(x - x10);

% plot
figure
plot(x_data, y_data, 'o');
hold on
fplot(p, [11.4 18]);
xlim([11.4 18]);
title('f vs. X (Newton Polynomial)');
xlabel('f (MHz)');
ylabel('X (Ohm)');
line(xlim(), [0,0], 'LineWidth', 1, 'Color', 'k'); % draw horizontal line at y = 0
line([12.65 12.65], ylim(), 'LineStyle', '--', 'LineWidth', 1, 'Color', 'k'); % draw vertical lines at roots of f
line([16.53 16.53], ylim(), 'LineStyle', '--', 'LineWidth', 1, 'Color', 'k');
legend('Given data', 'Interpolated data')
grid on
grid minor
hold off